# 다음 개발 진행 사항

PRD/TRD 및 현재 코드 기준으로, 완료된 항목과 남은 작업을 정리한 문서입니다.

---

## 현재 완료된 항목

- **로그인**: 2단계(전화번호 → 서비스영역/계정·비밀번호), state.json 저장, 에러 메시지 디코딩
- **로그아웃**: 개발자용 핫키(Cmd+Shift+L / Ctrl+Shift+L), `docs/로그인_테스트.md` §7에 기록
- **메인(잠금) 화면**: 근태정보 조회, 임시연장/긴급사용/PC-ON/PC-OFF 버튼, screenType·pcOnYn·긴급사용 정책 반영
- **API 연동**: getPcOffWorkTime, getPcOffServareaInfo, getPcOffLoginUserInfo, callPcOffTempDelay, callPcOffEmergencyUse, callCmmPcOnOffLogPrc
- **시뮬레이터·CI**: Flow-01~08 시나리오, parity-report.json, parity-summary.md, CI 아티팩트
- **로깅**: JSONL, TelemetryLogger, APP_START, LOGIN_SUCCESS/FAIL 등 일부 이벤트
- **업데이트·Guard·Auth**: 스캐폴드 수준(모의 다운로드/검증, 해시 기반 무결성, 비밀번호 변경 로그만)

---

## 다음 진행 사항 (우선순위 참고)

### 1. 자동 업데이트 실구현 (FR-03, Flow-03, Flow-04)

- **목표**: 업데이트 감지 시 사용자 확인 없이 백그라운드 다운로드 → 무결성 검증 → 적용
- **작업**: `UpdateManager`에 실제 패키지 URL/다운로드/검증(서명 또는 hash)/설치 로직, 실패 시 재시도 큐·롤백
- **DoD**: 사용자 Yes/No 다이얼로그 없이 적용되는지 검증

### 2. 비밀번호 변경 이벤트 + 확인 UI (FR-04, Flow-05)

- **목표**: 서버/설정에서 비밀번호 변경 감지 → 확인 UI만 표시, 비밀번호 검증/재로그인 없음
- **작업**: 서버 또는 주기 조회로 변경 이벤트 수신, `AuthPolicy` 연동, Renderer에 확인 다이얼로그 추가
- **DoD**: 비밀번호 입력 요구나 재로그인 요구가 없어야 함

### 3. Agent Guard 실구현 (FR-07, Flow-06)

- **목표**: 삭제/우회 탐지, 무결성 체크, 자동 복구 트리거
- **작업**: Windows(서비스·ACL·Watchdog), macOS(LaunchDaemon·notarization/code signing), 바이너리·중요 파일 모니터링, 탐지 시 로그·복구
- **DoD**: 삭제 가능하면 실패, 탐지 및 로그 전송 누락 시 실패

### 4. Ops Observer 실구현 (FR-08, Flow-07)

- **목표**: 비정상 종료·통신 두절·중지 상태를 중앙 서버에 보고
- **작업**: heartbeat 전송, 크래시/오프라인 감지 시 `OFFLINE_DETECTED` 등 로그 전송, 서버 API 연동
- **DoD**: 서버에 “중지/충돌/통신단절” 기록이 남아야 함

### 5. 설치자 레지스트리 (FR-09, Flow-08)

- **목표**: 설치 수행자 계정·사번·기기·설치 시각을 서버에 등록·조회
- **작업**: 설치 시 수집 로직, 서버 API 호출, (선택) 조회 UI/시뮬레이터
- **DoD**: 설치자 정보가 서버에서 조회 가능해야 함

### 6. 이석 해제 플로우 (Flow-02 연계)

- **목표**: 이석 화면에서 사유 입력 후 PC-ON(잠금 해제) 가능
- **작업**: 사유 입력 UI·필수 여부, 타이머 규칙, `callCmmPcOnOffLogPrc` 또는 관련 API와 연동
- **DoD**: 사유 입력·타이머 규칙이 기존(MFC)과 동일

### 7. 로그 코드 전수 반영 (PRD §7)

- **목표**: `docs/operations/logcode.md`와 매핑, 필수 이벤트 전부 로깅
- **작업**: LOGIN_SUCCESS/FAIL, LOCK_TRIGGERED/UNLOCK_TRIGGERED, UPDATE_*, PASSWORD_CHANGE_DETECTED/CONFIRM_DONE, AGENT_TAMPER_DETECTED/RECOVERED, CRASH_DETECTED, OFFLINE_DETECTED 등 누락 이벤트 추가
- **DoD**: 제품 요구사항의 필수 이벤트가 모두 기록·조회 가능

### 8. 패키징 및 플랫폼 검증 (NFR-01, DoD)

- **목표**: Windows installer, macOS pkg/dmg 빌드, 두 OS에서 설치·실행 검증
- **작업**: electron-builder 또는 동등 도구 설정, 코드 서명/notarization 정책 반영
- **DoD**: Windows·macOS 설치 및 실행 검증 완료

---

## 참고

- **단일 소스**: `PRD_5240_PcOff_Electron.md`, `TRD_5240_PcOff_Electron.md`, `PC_OFF_AGENT_API.md`, `VIBE_PROMPT_IMPLEMENTATION.md`
- **시뮬레이터**: `simulator/`, `artifacts/parity-report.json` — 새 플로우 추가 시 시나리오·parity 반영 권장
- **정의 완료(DoD)**: PRD §9 참고
