# 5240 PcOff Agent — Windows 설치·동작 확인 가이드

**대상**: Windows PC에서 설치된 「5240 PcOff Agent」를 대신 테스트해 주시는 분  
**목적**: 설치가 끝난 뒤 **트레이 아이콘**, **에이전트 화면**, **메뉴 동작**이 정상인지 확인하고, 문제가 있으면 **어떤 상황인지·어떤 로그를 보내야 하는지**를 정리합니다.

개발자는 Windows 환경이 없어 테스트를 의뢰하는 경우를 위해 이 문서를 작성했습니다.  
**이 문서를 그대로 테스트 담당자에게 전달**해 주시면 됩니다.

---

## 1. 테스트 전에 받을 것

테스트를 요청하는 쪽(개발자·담당자)에게 아래를 받아 두세요.

| 항목 | 설명 |
|------|------|
| **설치 파일** | `5240 PcOff Agent Setup x.x.x.exe` 형태의 설치 프로그램 (예: `5240 PcOff Agent Setup 0.1.0.exe`) |
| **테스트 계정 정보** (선택) | 서버 연동까지 확인할 경우: 전화번호, 서비스 영역, 사용자 ID, 비밀번호 |
| **이 문서** | `윈도우_설치_테스트_가이드.md` (또는 인쇄/PDF로 정리한 내용) |

---

## 2. 설치 방법

### 2.1 설치 실행

1. 받은 **설치 파일**(`.exe`)을 더블클릭합니다.
2. **「Windows의 PC 보호」 / SmartScreen 경고가 뜨는 경우** (아래 2.2 참고)  
   → **「추가 정보」**를 클릭한 뒤 **「실행」**을 눌러 진행합니다.  
   (테스트용 설치 파일은 서명되지 않아 Windows가 “인식할 수 없는 앱”으로 표시할 수 있습니다. 배포 담당자가 전달한 파일이면 위 단계로 실행해도 됩니다.)
3. **사용자 계정 컨트롤(UAC)** 창이 뜨면 **「예」**를 눌러 진행합니다.
4. 설치 마법사 안내에 따라 **다음**을 눌러 설치를 완료합니다.
5. **「설치 완료 후 5240 PcOff Agent 실행」**에 체크가 되어 있으면 설치가 끝나면 자동으로 앱이 실행됩니다.  
   체크를 해제했으면 **시작 메뉴** 또는 **바탕화면 바로가기**에서 「5240 PcOff Agent」를 실행합니다.

### 2.2 「Windows의 PC 보호」 / SmartScreen 경고가 뜰 때

설치 파일(`.exe`)을 실행하면 **Microsoft Defender SmartScreen**에서 아래와 비슷한 창이 뜰 수 있습니다.

- **제목**: 「Windows의 PC 보호」 (또는 PC 보호 관련 문구)
- **내용**: “Microsoft Defender SmartScreen에서 인식할 수 없는 앱의 시작을 차단했습니다. 이 앱을 실행하면 PC가 위험에 노출될 수 있습니다.”
- **버튼**: 「추가 정보」, 「실행 안 함」 등

**테스트용으로 배포 담당자(개발자)가 준 설치 파일이라면**, 아래 순서로 진행하면 됩니다.

1. **「추가 정보」** 링크를 클릭합니다.  
   → 창이 넓어지면서 아래쪽에 **「실행」** 버튼이 보입니다.
2. **「실행」** 버튼을 클릭합니다.  
   → 설치 프로그램이 실행됩니다. 이후 [2.1](#21-설치-실행)의 3번(UAC)부터 이어서 진행하면 됩니다.

**주의**

- **「실행 안 함」**을 누르면 설치가 진행되지 않습니다. 설치하려면 반드시 **「추가 정보」** → **「실행」**을 선택해야 합니다.
- 이 경고는 **서명되지 않은 앱**을 Windows가 “알 수 없는 출처”로 보고하기 때문에 나타납니다. 정식 코드 서명을 하면 이후 배포본에서는 이 경고가 줄어들 수 있습니다.

### 2.2 설치 후 첫 화면

- **정상**:  
  - **로그인 화면**이 뜨거나,  
  - 창은 안 떠도 **작업 표시줄 오른쪽(시계 근처)** 에 **트레이 아이콘**(^ 모양 옆에 작은 아이콘)이 보입니다.
- **이상**:  
  - 아무 창도 안 뜨고 트레이에도 아이콘이 전혀 안 보이면 → [5. 문제가 있을 때](#5-문제가-있을-때)로 이동해 확인·보고 방법을 따릅니다.

---

## 3. 트레이 아이콘 확인

### 3.1 트레이가 어디 있는지

- **작업 표시줄**: 화면 **맨 아래** 가로 막대.
- **트레이(시스템 트레이)**: 작업 표시줄 **오른쪽 끝**, **시계·Wi‑Fi·볼륨 아이콘**이 있는 쪽.
- **숨겨진 아이콘**: 트레이에 아이콘이 많으면 **^** (위쪽 화살표)를 클릭하면 숨겨진 아이콘이 나옵니다.  
  「5240 PcOff Agent」 아이콘도 여기 있을 수 있습니다.

### 3.2 확인할 것

| 확인 항목 | 방법 | 정상일 때 |
|-----------|------|-----------|
| **아이콘 존재** | 시계 쪽·^ 클릭 영역을 살펴봄 | PCOFF/에이전트 관련 아이콘이 보임 |
| **마우스 올리기** | 아이콘 위에 마우스를 올림 | "5240 PCOFF Agent - 클릭 또는 메뉴에서…" 같은 **툴팁**이 잠깐 보임 |
| **우클릭** | 아이콘을 **오른쪽 클릭** | **컨텍스트 메뉴**가 뜸 (아래 3.3 참고) |
| **좌클릭** | 아이콘을 **한 번 클릭** (왼쪽 버튼) | **에이전트(작동정보) 창**이 뜸 (다른 창 뒤에 있을 수 있음) |
| **더블클릭** | 아이콘을 **두 번 빠르게 클릭** | 에이전트(작동정보) 창이 뜸 |

### 3.3 우클릭 메뉴 내용

우클릭 시 아래와 비슷한 메뉴가 나오면 정상입니다.

- **PCOFF 작동정보** … 클릭 시 에이전트(작동정보) 창이 열림
- **잠금화면 열기** … 클릭 시 잠금 화면이 열림
- 구분선
- **로그 폴더 열기** … 클릭 시 로그가 저장된 폴더가 열림
- 구분선
- **현재 모드: NORMAL** (비활성 표시)
- 구분선
- **종료** … 클릭 시 앱이 완전히 종료됨

---

## 4. 에이전트 화면(창) 확인

### 4.1 창을 여는 방법 (순서대로 시도)

1. **트레이 아이콘 좌클릭**  
   → 에이전트(작동정보) 창이 떠야 합니다.
2. **트레이 아이콘 우클릭** → **「PCOFF 작동정보」** 선택  
   → 같은 창이 떠야 합니다.
3. **트레이 아이콘 우클릭** → **「잠금화면 열기」** 선택  
   → 잠금 화면 창이 떠야 합니다.
4. **창이 안 보일 때**:  
   - **작업 표시줄** 아래쪽을 보면 **「5240 PcOff Agent」** 또는 **「PCOFF 작동정보」** 창 버튼이 있을 수 있습니다.  
   - 그 버튼을 클릭하면 **다른 창 뒤에 가려져 있던 창**이 앞으로 나옵니다.
5. **단축키(핫키)** (앱이 실행 중일 때):  
   - **Ctrl + Shift + I** … 작동정보 창  
   - **Ctrl + Shift + K** … 잠금화면 창  
   - **Ctrl + Shift + L** … 로그아웃  
   - 설치 직후에는 **5~10초 정도 지난 뒤**부터 단축키가 동작할 수 있습니다. 다른 프로그램에 포커스가 있으면 동작하지 않을 수 있으니, 에이전트 창을 한 번 클릭한 뒤 다시 시도해 보세요.

### 4.2 에이전트(작동정보) 창이 정상일 때

- 제목 표시줄에 **「PCOFF 작동정보」** 또는 비슷한 문구가 보입니다.
- 화면에 **근태 정보**, **버튼** 등이 보입니다 (로그인한 경우).
- 로그인하지 않은 경우에는 **로그인 화면**이 먼저 나올 수 있습니다.

### 4.3 잠금화면이 정상일 때

- **「PC 사용이 종료되었습니다」** 같은 문구와  
  **임시연장**, **긴급사용**, **PC-ON**, **PC-OFF** 등의 버튼이 보입니다.

---

## 5. 문제가 있을 때

### 5.1 확인 순서

아래 표에서 **해당하는 증상**을 찾고, **할 일**을 순서대로 진행한 뒤, [6. 테스트 결과 전달](#6-테스트-결과-전달) 형식으로 보고하면 됩니다.

| 증상 | 먼저 할 일 | 그래도 안 되면 |
|------|------------|----------------|
| **설치 파일 실행 시 「Windows의 PC 보호」 경고만 뜨고 설치가 안 됨** | 경고 창에서 **「추가 정보」** 클릭 → **「실행」** 클릭. ([2.2](#22-windows의-pc-보호--smartscreen-경고가-뜰-때) 참고) | 「실행」 버튼이 안 보이거나 눌러도 진행이 안 되면 **경고 창 화면 캡처** 전달 |
| **트레이에 아이콘이 안 보임** | ^(숨겨진 아이콘) 클릭해서 확인. 앱을 한 번 종료했다가 다시 실행. | [5.2 로그 수집](#52-로그-수집) 후 전달 |
| **트레이 아이콘은 보이는데 클릭해도 반응 없음** | **우클릭** → 「PCOFF 작동정보」 또는 「잠금화면 열기」 선택. **작업 표시줄**에서 「5240 PcOff Agent」 창 클릭. | [5.2 로그 수집](#52-로그-수집) 후 전달 |
| **창은 뜨는데 내용이 비어 있음(흰 화면)** | 몇 초 기다리기. 창을 닫았다가 트레이에서 다시 열기. | [5.2 로그 수집](#52-로그-수집) + **화면 캡처** 전달 |
| **설치 중/실행 중 오류 메시지가 뜸** | 오류 메시지 **전문**을 복사하거나 **화면 캡처**. | 복사/캡처한 내용과 함께 [6. 테스트 결과 전달](#6-테스트-결과-전달) |
| **Ctrl+Shift+I / K / L 단축키가 안 됨** | 앱 실행 후 **5~10초 대기** 후 다시 시도. 에이전트 창을 한 번 클릭(포커스)한 뒤 단축키 입력. | 보안 소프트웨어·관리자 권한이 단축키를 막는지 확인. [5.2 로그 수집](#52-로그-수집) 후 전달 |

### 5.2 로그 수집

문제가 계속될 때는 **로그 파일**을 보내주면 원인 파악에 도움이 됩니다.

1. 트레이 아이콘이 보이는 경우  
   - 트레이 아이콘 **우클릭** → **「로그 폴더 열기」** 클릭  
   - 열린 폴더 안에 **날짜별 파일**(예: `2026-02-19.json`)이 있습니다.  
   - **당일 날짜**의 `.json` 파일을 복사해 전달합니다.  
   - (예: 테스트한 날이 2026년 2월 19일이면 `2026-02-19.json`)

2. 트레이가 안 보이거나 메뉴가 안 열리는 경우  
   - **파일 탐색기**를 열고 아래 경로로 이동해 봅니다.  
     `C:\Users\본인사용자이름\AppData\Roaming\5240 PcOff Agent\logs`  
     (본인사용자이름은 실제 Windows 로그인 계정 이름으로 바꿉니다.)  
   - 해당 폴더의 **당일 `.json` 파일**을 복사해 전달합니다.

3. **AppData** 폴더가 안 보일 때  
   - 파일 탐색기 **보기** 메뉴에서 **「숨긴 항목」**에 체크합니다.  
   - 또는 주소창에 `%APPDATA%\5240 PcOff Agent\logs` 를 입력해 Enter로 이동할 수 있습니다.

---

## 6. 테스트 결과 전달

테스트를 요청한 쪽(개발자·담당자)에게 아래 형식으로 알려주시면 됩니다.

### 6.1 꼭 적어 줄 것

- **테스트한 날짜·시간** (예: 2026-02-19 14:00경)
- **Windows 버전** (예: Windows 11 23H2)  
  - 확인: **설정** → **시스템** → **정보** 에서 확인 가능
- **설치 파일 이름** (예: 5240 PcOff Agent Setup 0.1.0.exe)
- **확인 결과 요약**  
  - 트레이 아이콘: 보임 / 안 보임 / ^ 안에만 보임  
  - 좌클릭: 창 뜸 / 반응 없음 / 모름  
  - 우클릭 메뉴: 뜸 / 안 뜸  
  - 「PCOFF 작동정보」 선택 시: 창 뜸 / 안 뜸 / 흰 화면  
  - 「잠금화면 열기」 선택 시: 창 뜸 / 안 뜸 / 흰 화면  
  - 작업 표시줄에 창 버튼: 보임 / 안 보임

### 6.2 가능하면 함께 보낼 것

- **당일 로그 파일** (`YYYY-MM-DD.json`) — [5.2 로그 수집](#52-로그-수집) 참고
- **오류 메시지**가 있었다면: 전문 복사 또는 화면 캡처
- **흰 화면·이상한 화면**이었다면: 해당 화면 캡처

### 6.3 체크리스트 (복사해서 O/X 로 채워서 보내도 됨)

```
[ ] 설치 파일 실행 시 SmartScreen 경고가 떴다면: 「추가 정보」 → 「실행」으로 진행함
[ ] 설치가 끝까지 완료됨
[ ] 트레이(시계 쪽)에 5240 PcOff Agent 아이콘이 보임
[ ] 아이콘 위에 마우스 올리면 툴팁이 보임
[ ] 아이콘 우클릭 시 메뉴가 뜸 (PCOFF 작동정보, 잠금화면 열기 등)
[ ] 아이콘 좌클릭 시 창이 뜸
[ ] 우클릭 → "PCOFF 작동정보" 선택 시 창이 뜸
[ ] 우클릭 → "잠금화면 열기" 선택 시 잠금 화면이 뜸
[ ] 뜬 창에 내용(버튼·글자)이 정상적으로 보임
[ ] 문제 발생 시: 당일 .json 로그 파일 전달 가능
```

---

## 7. 요약 — 최소한으로만 확인할 때

1. **설치**  
   `5240 PcOff Agent Setup x.x.x.exe` 실행 → **「Windows의 PC 보호」 경고가 뜨면 「추가 정보」 → 「실행」** → 설치 완료 후 앱 실행(또는 시작 메뉴에서 실행).
2. **트레이**  
   작업 표시줄 오른쪽(시계·^ 쪽)에 PCOFF 아이콘이 있는지 확인.
3. **우클릭**  
   아이콘 우클릭 → 「PCOFF 작동정보」, 「잠금화면 열기」가 보이고, 선택 시 창이 뜨는지 확인.
4. **창이 안 보이면**  
   작업 표시줄에서 「5240 PcOff Agent」 창을 클릭해 보기.
5. **문제가 있으면**  
   당일 로그 파일(`YYYY-MM-DD.json`)과 증상·체크리스트를 [6. 테스트 결과 전달](#6-테스트-결과-전달) 형식으로 전달.

이 문서는 `docs/윈도우_설치_테스트_가이드.md` 로 프로젝트에 포함되어 있으며, 필요 시 개발자에게 최신본을 요청하시면 됩니다.
