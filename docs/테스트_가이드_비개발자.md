# 5240 PcOff Agent — 테스트 가이드 (비개발자용)

이 문서는 코딩 경험이 없어도 따라 할 수 있도록 테스트 방법을 단계별로 적어 둔 것입니다.  
**개발자에게 받은 폴더(프로젝트)와 테스트용 계정 정보**가 있으면 됩니다.

---

## 1. 테스트 전 준비

### 1.1 필요한 것

- **프로젝트 폴더**  
  개발자가 전달한 「5240 PcOff Agent」 프로젝트가 들어 있는 폴더(예: `PCOFF_TEST`).
- **Node.js 설치 여부**  
  터미널(명령 프롬프트)에서 `node -v` 입력 시 버전 번호가 나오면 됩니다.  
  나오지 않으면 개발자에게 “Node.js 설치해 주세요”라고 요청하세요.
- **테스트 계정 정보** (서버 연동 테스트 시)  
  - 전화번호  
  - 서비스 영역 이름(또는 목록에서 고를 수 있음)  
  - 사용자 ID  
  - 비밀번호  

위 정보는 **운영/개발 담당자**에게 받으면 됩니다.

### 1.2 터미널(명령 창) 여는 방법

- **Windows**:  
  - 프로젝트 폴더를 연 뒤 상단 주소창에 `cmd` 입력 후 Enter  
  - 또는 `시작 메뉴 → Windows 보조 프로그램 → 명령 프롬프트` 실행 후, `cd` 명령으로 프로젝트 폴더로 이동
- **macOS**:  
  - `Spotlight(Command+Space)` → `터미널` 입력 후 실행  
  - `cd` 명령으로 프로젝트 폴더로 이동 (예: `cd 바탕화면/PCOFF_TEST`)

---

## 2. 앱 실행 (가장 기본 테스트)

목적: **앱이 정상적으로 실행되는지** 확인합니다.

### 2.1 단계

1. 터미널(명령 프롬프트)을 연다.
2. 프로젝트 폴더로 이동한다.  
   예: `cd C:\경로\PCOFF_TEST` (Windows), `cd /Users/이름/경로/PCOFF_TEST` (macOS)
3. 아래 세 줄을 **한 줄씩** 입력하고 Enter를 누른다.  
   (이미 했다면 2번·3번만 해도 됨)
   ```
   npm install
   npm run build
   npm start
   ```

### 2.2 예상 결과

- **처음 실행이거나, 로그인한 적이 없을 때**  
  → **로그인 화면**이 뜹니다.  
  - 왼쪽 위에 「5240」「PCOFF AGENT」, 큰 글씨로 「로그인」, 전화번호 입력 칸이 보이면 정상입니다.
- **이미 로그인한 적이 있을 때**  
  → **잠금(메인) 화면**이 바로 뜹니다.  
  - 「PC 사용이 종료되었습니다」 같은 문구와, 아래쪽에 「임시연장」「긴급사용」「PC-ON」「PC-OFF」 버튼이 보이면 정상입니다.

### 2.3 문제가 생겼을 때

- **「npm을 찾을 수 없습니다」**  
  → Node.js가 설치되지 않았거나, 터미널을 새로 열지 않은 상태입니다. Node.js 설치 후 터미널을 다시 열고 2.1부터 다시 진행하세요.
- **창이 안 뜨거나 곧 꺼짐**  
  → 터미널에 빨간색 에러 메시지가 있는지 확인하고, 그 내용을 캡처해서 개발자에게 전달하세요.
- **macOS에서 "whenReady" 관련 에러**  
  → 터미널에서 `unset ELECTRON_RUN_AS_NODE` 입력 후 Enter, 그다음 `npm start`를 다시 실행해 보세요.

### 2.4 설치된 앱(인스톨러) 사용 시

- **로그인 상태**  
  설치된 앱은 **개발 시(`npm start`)와 상태가 분리**됩니다. 인스톨러로 설치한 앱을 처음 실행하면 **로그인 화면**이 나오고, 개발 시에 로그인했던 기록은 설치 앱에 적용되지 않습니다.
- **전역 단축키(핫키)가 동작하지 않을 때**  
  - **macOS**: **시스템 설정** → **개인 정보 보호 및 보안** → **손쉬운 사용**(또는 **접근성**)에서 「5240 PcOff Agent」에 **체크**가 있어야 전역 단축키(Cmd+Shift+L / I / K)가 동작합니다. 체크 후 앱을 한 번 종료했다가 다시 실행해 보세요.  
  - **Windows**: 앱을 **한 번 실행한 뒤 5~10초 정도 지난 후**부터 핫키(Ctrl+Shift+L / I / K)가 동작할 수 있습니다. 다른 앱이 포커스를 잡고 있으면 동작하지 않을 수 있으니, 에이전트 창을 한 번 클릭한 뒤 다시 시도해 보세요. 관리자 권한·보안 소프트웨어가 단축키를 막는 경우 해당 앱 예외 처리 여부를 확인하세요.
- **Windows: 트레이에서 선택이 안 되거나 에이전트 화면이 안 뜰 때**  
  - 트레이 아이콘 **왼쪽 클릭**으로 창이 안 뜨면, **우클릭** → **「PCOFF 작동정보」** 또는 **「잠금화면 열기」**를 선택해 보세요.  
  - 그래도 안 되면 앱을 한 번 종료한 뒤 다시 실행하고, 트레이 아이콘을 다시 클릭해 보세요.  
  - 여전히 창이 안 보이면 **다른 창 뒤**에 있을 수 있으니 작업 표시줄에서 「5240 PcOff Agent」 창을 클릭해 보세요.  
  - 문제가 계속되면 **로그 폴더**(트레이 메뉴 → 로그 폴더 열기)의 당일 JSONL 로그를 개발자에게 전달하세요.  
  - **Windows 전용 상세 확인 절차**(설치·트레이·창·로그 수집·보고 형식)는 **`docs/윈도우_설치_테스트_가이드.md`** 를 참고하세요. (Windows가 없는 환경에서 테스트 의뢰 시 해당 문서를 그대로 전달하면 됩니다.)

---

## 3. 로그인 테스트 (화면 동작 확인)

목적: **로그인 화면에서 전화번호 → 서비스 영역 선택 → ID/비밀번호 입력 → 로그인**이 순서대로 되는지 확인합니다.

### 3.1 로그인 화면이 나오게 하기

- **처음 설치한 상태**  
  → 그냥 2번처럼 `npm start`만 하면 로그인 화면이 나옵니다.
- **이미 로그인된 상태(잠금 화면만 보일 때)**  
  → 개발자에게 “로그인 화면부터 다시 테스트하고 싶다”고 하고, 아래 중 하나를 요청하세요.  
  - `config.json` 또는 `state.json`에서 로그인 정보를 빼는 방법  
  - 또는 **로그아웃 단축키**:  
    - Windows: **Ctrl + Shift + L**  
    - Mac: **Cmd + Shift + L**  
    (**어디서든** 위 키를 누르면 로그인 화면으로 돌아갑니다. 맥에서 메뉴 막대 아이콘이 안 보여도 사용 가능합니다.)

### 3.2 1단계 — 전화번호 입력

1. 로그인 화면에서 **전화번호** 칸을 클릭한다.
2. **사용할 전화번호**를 입력한다.  
   - `010-1234-5678` 처럼 하이픈 있어도 되고, `01012345678` 처럼 없어도 됩니다.
3. **「다음」** 버튼(파란색)을 클릭한다. (전화번호 입력 후 **Enter** 키를 눌러도 됩니다.)

**예상 결과**

- **정상**:  
  - 잠깐 후 화면이 바뀌어 **서비스 영역**을 고르는 메뉴(드롭다운)와 **사용자 ID**, **비밀번호** 입력 칸이 보인다.
- **비정상**:  
  - 빨간색으로 「등록된 서비스 영역이 없습니다」 → 전화번호가 서버에 등록되지 않았거나, 서버 주소 설정이 잘못된 경우입니다. 담당자에게 확인 요청하세요.  
  - 「API 주소가 설정되지 않았습니다」 → 개발자에게 `config.json`의 `apiBaseUrl` 설정을 요청하세요.

### 3.3 2단계 — 서비스 영역·ID·비밀번호 입력

1. **서비스 영역** 드롭다운을 클릭해 목록을 연다.
2. **본인에게 안내된 서비스 영역**(예: 본사, 오이사공 등)을 선택한다.
3. **사용자 ID** 칸에 테스트용 ID를 입력한다(예: 0006).
4. **비밀번호** 칸에 테스트용 비밀번호를 입력한다.
5. **「로그인」** 버튼(파란색)을 클릭한다. (서비스 영역·ID·비밀번호 입력 후 **Enter** 키를 눌러도 됩니다.)

**예상 결과**

- **정상**:  
  - **서버에서 사용시간이 종료된 상태(pcOnYn=N)**이면 → **같은 창**에서 **잠금화면**으로 전환되고, 아래쪽에 「임시연장」「긴급사용」「PC-ON」「PC-OFF」 버튼이 보인다.  
  - **사용시간이 남아 있는 상태**이면 → **같은 창**에서 **에이전트(작동정보)** 화면으로 전환되거나 창이 닫힐 수 있다. (잠금화면은 사용시간이 끝날 때 자동으로 뜹니다.)
- **비정상**:  
  - 빨간색으로 「사용자 조회에 실패했습니다. 아이디와 비밀번호를 확인해주세요.»  
  → ID/비밀번호가 틀렸거나, 해당 서비스 영역에 등록된 계정이 아닐 수 있습니다. 담당자에게 계정 정보를 다시 확인받으세요.

### 3.4 이전으로 돌아가기

- 2단계 화면에서 **「이전」** 버튼을 누르면, 다시 **전화번호 입력(1단계)** 화면으로 돌아갑니다.

---

## 4. 잠금(메인) 화면 테스트

목적: **로그인 후 메인 화면의 버튼과 정보가 보이는지** 확인합니다.

### 4.1 확인할 것

1. **상단**  
   - 왼쪽: 「5240」「PCOFF AGENT」  
   - 오른쪽: 「업데이트 확인」 버튼, 상태 표시(예: state: …)
2. **가운데**  
   - 잠금 안내 문구(예: 「PC 사용이 종료되었습니다」)  
   - 「나의 근태정보 불러오기」 버튼
3. **하단**  
   - 왼쪽: 「임시연장」「긴급사용」  
   - 가운데: 현재 날짜·시간  
   - 오른쪽: 「PC-ON」「PC-OFF」

### 4.2 버튼 눌러 보기

- **「나의 근태정보 불러오기」**  
  → 클릭 시 오른쪽 아래에 **근태정보 패널**이 뜨고, PC 사용 가능 시간·임시연장 횟수 등이 표시되면 정상입니다.
- **「임시연장」**  
  → 클릭 시 잠시 후 화면 하단에 「임시연장 완료」 같은 **토스트 메시지**가 나오면 요청이 들어간 것입니다. (실제 연장 여부는 서버 정책에 따릅니다.)
- **「긴급사용」**  
  → 클릭 시 **사유 입력 창**이 뜨면, 사유를 입력한 뒤 확인하면 요청이 들어갑니다. 성공하면 **같은 창이 에이전트(작동정보) 화면**으로 전환됩니다. (잠금 해제 동작)
- **「PC-ON」**  
  → **출근(PC 사용 시작)** 기록을 서버에 보냅니다. 성공하면 「PC-ON 완료」 토스트가 나오고, **같은 창이 에이전트(작동정보) 화면**으로 전환되어 다른 프로그램을 사용할 수 있습니다. (잠금 해제 동작)
- **「PC-OFF」**  
  → **퇴근(PC 사용 종료)** 기록을 서버에 보냅니다. 「PC-OFF 완료」 토스트가 나오면 정상입니다. (이미 잠금 화면이 보이는 상태이므로 창 동작은 없습니다.)

※ 위 버튼들은 **실제 서버와 연동**되어 있으므로, 테스트 시에는 담당자와 협의한 계정·시간대에서 확인하는 것이 좋습니다.

### 4.3 이석 자동 감지(유휴·절전) 안내

서버에서 **이석 감지 사용(leaveSeatUseYn=Y)** 및 **이석 시간(leaveSeatTime, 분)**이 설정된 경우, 아래와 같이 **자동으로 잠금화면**이 뜰 수 있습니다.

- **유휴(Idle)**  
  PC에서 키보드·마우스를 일정 시간(예: 1분) 사용하지 않으면 → **잠금화면**이 자동으로 표시됩니다.  
  이때 화면에는 「이석 감지」 관련 문구와 **PC-ON** 버튼이 보이며, 정책에 따라 **사유 입력** 후 PC-ON이 가능합니다.
- **절전 후 복귀**  
  PC가 절전 모드로 들어갔다가 깨어난 뒤, 절전 시간이 이석 시간(분) 이상이면 → 마찬가지로 **잠금화면**이 표시됩니다.

이 동작은 **서버 설정(이석 사용 여부·이석 시간)**에 따라 달라지며, 테스트 시에는 담당자에게 해당 계정의 이석 정책 여부를 확인받는 것이 좋습니다.

---

## 4.5 잠금화면만 따로 테스트하는 방법

**잠금화면**은 「사용시간 종료」 시 자동으로 뜨는 화면이며, 임시연장·긴급사용·PC-ON·PC-OFF 버튼이 있습니다.  
서버가 “PC 사용 불가(pcOnYn=N)”로 내려주지 않으면 자동으로는 안 뜨므로, **수동으로 열어서** UI·버튼 동작만 확인할 수 있습니다.

### 방법 1 — 트레이 메뉴에서 수동으로 열기 (가장 간단)

1. 앱을 실행한 뒤 **로그인**까지 완료한다.
2. 화면 위쪽 **메뉴 막대**(또는 작업 표시줄)에서 **PCOFF(에이전트) 아이콘**을 찾는다.  
   - macOS: 화면 오른쪽 위 시계 근처 **트레이(메뉴 막대)**  
   - Windows: 화면 오른쪽 아래 **시스템 트레이**
3. 아이콘을 **우클릭**(또는 해당 OS에서 컨텍스트 메뉴 여는 방법)한다.
4. 메뉴에서 **「잠금화면 열기」**를 클릭한다.

**예상 결과**  
- **같은 앱 창**에서 **잠금화면**이 표시된다. (새 창이 따로 뜨지 않음.)  
- 상단에 「5240」「PCOFF AGENT」, 가운데 잠금 안내 문구, 하단에 **임시연장·긴급사용·PC-ON·PC-OFF** 버튼이 보이면 정상이다.  
- 「나의 근태정보 불러오기」로 근태 패널이 뜨는지, 각 버튼을 눌렀을 때 토스트나 다음 동작이 나오는지 확인하면 된다.

### 방법 2 — 서버에서 “사용시간 종료”로 내려주게 해서 자동으로 뜨게 하기

- 서버(**getPcOffWorkTime** API)가 **pcOnYn = N**(PC 사용 불가)을 내려주는 계정·시간대로 설정해 두면,  
  - **앱 시작 시** 또는 **로그인 직후**, 또는  
  - **약 1분마다** 앱이 자동으로 상태를 조회한 뒤  
  **잠금화면이 자동으로** 뜬다.
- 이 방식은 **서버/정책 설정이 필요**하므로, 테스트용 계정·시간대를 담당자에게 요청해 두고 사용하는 것이 좋다.

### 방법 3 — Dock(또는 작업 표시줄)에서 잠금화면이 이미 떠 있는 경우

- 이미 **잠금화면**이 떠 있는 상태라면, Dock(또는 작업 표시줄)에서 **Electron(5240 PCOFF)** 아이콘을 클릭해 잠금화면 창이 앞으로 오는지 확인한다.
- 그 창에서 위 4.2와 같이 **나의 근태정보 불러오기**, **임시연장**, **긴급사용**, **PC-ON**, **PC-OFF** 동작을 한 번씩 눌러 보면 된다.

**요약**  
- **UI·버튼만 빠르게 확인**: 트레이 → **「잠금화면 열기」** 로 수동 오픈 후 4.2 항목대로 테스트.  
- **자동으로 잠금화면이 뜨는지 확인**: 서버에서 사용시간 종료(pcOnYn=N)가 되도록 설정한 뒤 앱 실행·로그인 또는 1분 정도 대기.

---

## 4.6 전역 단축키 (맥에서 메뉴 막대 아이콘이 안 보일 때)

앱이 실행 중이면 **어느 창이 포커스되어 있든** 아래 단축키로 동작합니다.

| 동작 | Windows | Mac |
|------|---------|-----|
| **로그아웃** (로그인 화면으로) | Ctrl + Shift + L | Cmd + Shift + L |
| **PCOFF 작동정보** 창 열기 | Ctrl + Shift + I | Cmd + Shift + I |
| **잠금화면** 창 열기 | Ctrl + Shift + K | Cmd + Shift + K |

맥에서 메뉴 막대(트레이)에 PCOFF 아이콘이 안 보이면, **Cmd+Shift+I**로 작동정보 창을, **Cmd+Shift+K**로 잠금화면을 열 수 있습니다.

---

## 5. 자주 나오는 문제 정리

| 화면/증상 | 가능한 원인 | 할 일 |
|-----------|-------------|--------|
| 로그인 화면이 안 나오고 잠금 화면만 보임 | 이미 로그인된 상태 | 로그아웃 단축키(Ctrl+Shift+L / Cmd+Shift+L) 후 다시 실행, 또는 개발자에게 config/state 초기화 요청 |
| 「등록된 서비스 영역이 없습니다」 | 전화번호 미등록 또는 서버 설정 문제 | 담당자에게 전화번호 등록·서버 주소(config.json) 확인 요청 |
| 「사용자 조회에 실패했습니다…」 | ID/비밀번호 오류 또는 권한 문제 | 담당자에게 테스트 계정·서비스 영역 재확인 요청 |
| 「Preload가 로드되지 않았습니다」 | 브라우저로 연 경우 | 반드시 **터미널에서 `npm start`로 실행**한 창에서 테스트. 브라우저 주소창으로 연 화면에서는 로그인 기능이 동작하지 않습니다. |
| 버튼을 눌러도 반응이 없음 | 서버 미연동 또는 네트워크 문제 | 인터넷 연결 확인, config.json의 apiBaseUrl이 맞는지 개발자에게 확인 요청 |

---

## 6. 테스트 결과 전달 방법

테스트 후 아래 내용을 정리해 개발자에게 전달하면 도움이 됩니다.

- **테스트한 날짜·시간**
- **OS** (예: Windows 11, macOS 14)
- **어디까지 진행했는지**  
  (예: 2번 앱 실행 → 정상, 3번 로그인 1단계 → 서비스 영역 안 나옴)
- **화면에 나온 메시지**  
  (빨간색 에러 문구가 있었다면 그대로 복사)
- **가능하면 화면 캡처**  
  (에러가 났을 때의 화면, 또는 “여기서 막혔다”는 화면)

---

## 7. 요약 — 최소한으로만 테스트할 때

1. 터미널을 열고 프로젝트 폴더로 이동.
2. `npm install` → `npm run build` → `npm start` 순서로 입력.
3. **로그인 화면** 또는 **잠금 화면**이 뜨는지 확인.
4. 로그인 화면이 떴다면: 전화번호 입력 → **다음** → 서비스 영역 선택 → ID·비밀번호 입력 → **로그인**.
5. 잠금 화면이 떴다면: **나의 근태정보 불러오기**, **임시연장**, **PC-ON** 중 하나라도 눌러서 토스트나 패널이 나오는지 확인.

여기까지 되면 “실행·로그인·메인 화면 동작”이 **기본적으로 동작한다**고 보면 됩니다.  
더 자세한 시나리오(자동 업데이트, 비밀번호 변경 알림, Agent Guard 무결성 감시 등)는 개발자에게 문의하세요.
